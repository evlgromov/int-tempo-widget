<template>
  <div>
    <div v-if="showWidget" style="display:flex;flex-direction: column;background: #fff;box-shadow: 0px 0px 15px 0px rgba(34, 60, 80, 0.2);width: 600px;height: 800px;position:absolute;bottom: 20px;right: 20px;z-index: 10;border-radius: 8px;">
      <ChatPage v-if="dialogueId" @toggleShowWidget="toggleShowWidget"/>
      <Login v-else @toggleView="toggleView" @toggleShowWidget="toggleShowWidget"/>
    </div>
    <div v-else @click="toggleShowWidget">
      <svg xmlns="http://www.w3.org/2000/svg" style="position:absolute;bottom: 20px;right: 20px;" width="70" height="70" viewBox="0 0 301 301" fill="none">
        <circle cx="150.168" cy="150.057" r="150" fill="url(#paint0_linear_3045_59037)"/>
        <path d="M58.9162 188.675C54.0401 188.675 49.8718 187.888 46.4113 186.315C42.9509 184.664 40.3162 182.147 38.5073 178.765C36.7771 175.383 35.912 171.137 35.912 166.024V141.251H26.7103C25.8452 141.251 25.1373 140.975 24.5868 140.425C24.0363 139.874 23.761 139.167 23.761 138.301V130.279C23.761 129.414 24.0363 128.706 24.5868 128.156C25.1373 127.605 25.8452 127.33 26.7103 127.33H35.912V107.865C35.912 107 36.1872 106.292 36.7378 105.742C37.3669 105.191 38.0748 104.916 38.8612 104.916H50.4223C51.2874 104.916 51.9953 105.191 52.5458 105.742C53.0963 106.292 53.3716 107 53.3716 107.865V127.33H68.1179C68.9044 127.33 69.5729 127.605 70.1234 128.156C70.6739 128.706 70.9492 129.414 70.9492 130.279V138.301C70.9492 139.167 70.6739 139.874 70.1234 140.425C69.5729 140.975 68.9044 141.251 68.1179 141.251H53.3716V164.609C53.3716 167.597 53.8828 169.957 54.9052 171.687C56.0063 173.339 57.8938 174.164 60.5678 174.164H69.1796C69.9661 174.164 70.6346 174.44 71.1851 174.99C71.7357 175.541 72.0109 176.209 72.0109 176.996V185.726C72.0109 186.591 71.7357 187.298 71.1851 187.849C70.6346 188.4 69.9661 188.675 69.1796 188.675H58.9162ZM84.5444 188.675C83.6792 188.675 82.9714 188.4 82.4209 187.849C81.8704 187.298 81.5951 186.591 81.5951 185.726V172.513C81.5951 171.648 81.8704 170.94 82.4209 170.389C82.9714 169.839 83.6792 169.564 84.5444 169.564H97.757C98.6222 169.564 99.33 169.839 99.8805 170.389C100.431 170.94 100.706 171.648 100.706 172.513V185.726C100.706 186.591 100.431 187.298 99.8805 187.849C99.33 188.4 98.6222 188.675 97.757 188.675H84.5444ZM103.951 211.089C103.086 211.089 102.378 210.814 101.828 210.263C101.277 209.713 101.002 209.005 101.002 208.14V200.118C101.002 199.253 101.277 198.545 101.828 197.994C102.378 197.444 103.086 197.169 103.951 197.169H107.726C109.85 197.169 111.462 196.736 112.563 195.871C113.743 195.085 114.529 193.983 114.923 192.568C115.316 191.152 115.513 189.579 115.513 187.849V130.279C115.513 129.414 115.788 128.706 116.338 128.156C116.889 127.605 117.557 127.33 118.344 127.33H130.731C131.517 127.33 132.186 127.605 132.736 128.156C133.287 128.706 133.562 129.414 133.562 130.279V188.203C133.562 193 132.658 197.09 130.849 200.472C129.04 203.932 126.326 206.567 122.709 208.376C119.17 210.185 114.765 211.089 109.496 211.089H103.951ZM117.99 117.893C117.203 117.893 116.535 117.617 115.984 117.067C115.434 116.516 115.159 115.808 115.159 114.943V105.506C115.159 104.641 115.434 103.933 115.984 103.382C116.535 102.753 117.203 102.438 117.99 102.438H130.967C131.832 102.438 132.54 102.753 133.09 103.382C133.641 103.933 133.916 104.641 133.916 105.506V114.943C133.916 115.808 133.641 116.516 133.09 117.067C132.54 117.617 131.832 117.893 130.967 117.893H117.99ZM176.969 189.855C170.441 189.855 164.975 188.793 160.571 186.669C156.167 184.467 152.785 181.361 150.425 177.35C148.145 173.339 146.886 168.659 146.65 163.311C146.572 161.738 146.532 159.969 146.532 158.002C146.532 155.958 146.572 154.188 146.65 152.694C146.886 147.267 148.223 142.588 150.661 138.655C153.099 134.644 156.52 131.577 160.925 129.454C165.329 127.252 170.677 126.15 176.969 126.15C183.182 126.15 188.49 127.252 192.895 129.454C197.299 131.577 200.72 134.644 203.158 138.655C205.596 142.588 206.933 147.267 207.169 152.694C207.326 154.188 207.405 155.958 207.405 158.002C207.405 159.969 207.326 161.738 207.169 163.311C206.933 168.659 205.635 173.339 203.276 177.35C200.995 181.361 197.653 184.467 193.249 186.669C188.844 188.793 183.418 189.855 176.969 189.855ZM176.969 176.878C180.822 176.878 183.732 175.698 185.698 173.339C187.665 170.901 188.726 167.361 188.884 162.721C188.962 161.542 189.002 159.969 189.002 158.002C189.002 156.036 188.962 154.463 188.884 153.284C188.726 148.722 187.665 145.222 185.698 142.784C183.732 140.346 180.822 139.127 176.969 139.127C173.115 139.127 170.166 140.346 168.121 142.784C166.155 145.222 165.093 148.722 164.936 153.284C164.857 154.463 164.818 156.036 164.818 158.002C164.818 159.969 164.857 161.542 164.936 162.721C165.093 167.361 166.155 170.901 168.121 173.339C170.166 175.698 173.115 176.878 176.969 176.878ZM255.37 189.855C250.887 189.855 247.152 189.107 244.163 187.613C241.174 186.04 238.736 184.074 236.849 181.715V185.726C236.849 186.591 236.574 187.298 236.023 187.849C235.472 188.4 234.765 188.675 233.9 188.675H222.692C221.827 188.675 221.119 188.4 220.569 187.849C220.018 187.298 219.743 186.591 219.743 185.726V107.865C219.743 107 220.018 106.292 220.569 105.742C221.119 105.191 221.827 104.916 222.692 104.916H234.843C235.63 104.916 236.298 105.191 236.849 105.742C237.399 106.292 237.675 107 237.675 107.865V133.583C239.641 131.38 242.079 129.611 244.989 128.274C247.899 126.858 251.359 126.15 255.37 126.15C259.46 126.15 262.999 126.858 265.987 128.274C269.055 129.611 271.65 131.538 273.774 134.054C275.897 136.493 277.509 139.402 278.61 142.784C279.79 146.166 280.419 149.902 280.498 153.991C280.577 155.407 280.616 156.744 280.616 158.002C280.616 159.182 280.577 160.519 280.498 162.013C280.341 166.182 279.672 169.996 278.492 173.457C277.391 176.838 275.779 179.788 273.656 182.304C271.611 184.742 269.055 186.63 265.987 187.967C262.999 189.225 259.46 189.855 255.37 189.855ZM250.061 175.698C253.05 175.698 255.409 175.069 257.14 173.811C258.87 172.474 260.089 170.743 260.797 168.62C261.583 166.496 262.055 164.176 262.212 161.66C262.37 159.222 262.37 156.783 262.212 154.345C262.055 151.829 261.583 149.509 260.797 147.385C260.089 145.262 258.87 143.571 257.14 142.312C255.409 140.975 253.05 140.307 250.061 140.307C247.23 140.307 244.91 140.936 243.101 142.194C241.371 143.453 240.034 145.065 239.09 147.031C238.225 148.919 237.753 150.964 237.675 153.166C237.596 154.581 237.557 156.036 237.557 157.531C237.557 159.025 237.596 160.519 237.675 162.013C237.832 164.373 238.304 166.575 239.09 168.62C239.877 170.665 241.174 172.356 242.983 173.693C244.792 175.03 247.152 175.698 250.061 175.698Z" fill="white"/>
        <defs>
          <linearGradient id="paint0_linear_3045_59037" x1="107.981" y1="0.0566411" x2="239.761" y2="340.308" gradientUnits="userSpaceOnUse">
            <stop stop-color="#FA7204"/>
            <stop offset="1" stop-color="#FFAD0D"/>
          </linearGradient>
        </defs>
      </svg>
    </div>
  </div>
</template>

<script>
import Login from "@/pages/Login";
import ChatPage from "@/pages/ChatPage";
import { ref } from 'vue'

export default {
  name: 'App',
  components: {ChatPage, Login},
  props: {
    chatbotId: String
  },
  setup(props) {
    localStorage.setItem('chatbotId', props.chatbotId)
    const dialogueId = ref(localStorage.getItem('dialogue_id'))

    const showWidget = ref(false)

    const toggleShowWidget = () => {
      showWidget.value = !showWidget.value
    }

    const toggleView = (id) => {
      dialogueId.value = id;
    }

    return { dialogueId, toggleView, showWidget, toggleShowWidget }
  }
}
</script>

<style scoped>
#app {
  font-family: Avenir, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}

.widget {
  background: #fff;
  box-shadow: 0px 0px 15px 0px rgba(34, 60, 80, 0.2);
  width: 600px;
  height: 900px;
}
</style>
